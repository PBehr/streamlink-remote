version: '3.8'

services:
  streamlink-remote-dev:
    build: .
    container_name: streamlink-remote-dev
    ports:
      - "${SERVER_PORT:-3000}:${SERVER_PORT:-3000}"
      - "${STREAM_PORT_START:-8080}-${STREAM_PORT_END:-8089}:${STREAM_PORT_START:-8080}-${STREAM_PORT_END:-8089}"
    volumes:
      - ./data:/app/data
      - ./config:/app/config
    environment:
      - NODE_ENV=production
      - SERVER_PORT=${SERVER_PORT:-3000}
      - SERVER_HOST=${SERVER_HOST:-0.0.0.0}
      - EXTERNAL_HOST=${EXTERNAL_HOST}
      - STREAM_PORT_START=${STREAM_PORT_START:-8080}
      - STREAM_PORT_END=${STREAM_PORT_END:-8089}
      - TWITCH_CLIENT_ID=${TWITCH_CLIENT_ID}
      - TWITCH_REDIRECT_URI=${TWITCH_REDIRECT_URI}
      - STREAMLINK_EXECUTABLE=${STREAMLINK_EXECUTABLE:-streamlink}
      - STREAMLINK_DEFAULT_QUALITY=${STREAMLINK_DEFAULT_QUALITY:-best}
      - MANUAL_AUTH_ACCESS_TOKEN=${MANUAL_AUTH_ACCESS_TOKEN}
      - MANUAL_AUTH_USER_ID=${MANUAL_AUTH_USER_ID}
      - MANUAL_AUTH_USER_LOGIN=${MANUAL_AUTH_USER_LOGIN}
      - MANUAL_AUTH_USER_DISPLAY_NAME=${MANUAL_AUTH_USER_DISPLAY_NAME}
      - MANUAL_AUTH_EXPIRES_AT=${MANUAL_AUTH_EXPIRES_AT}
    restart: unless-stopped
    networks:
      - streamlink-dev-network

networks:
  streamlink-dev-network:
    driver: bridge
